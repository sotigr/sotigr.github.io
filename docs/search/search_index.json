{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to my little note dump","text":"<p>In here I store notes and guides of my various hobbies, but mostly coding, computer tinkering and 3D printing </p> <p>this is a test</p> <pre><code> import (  \"fmt\"\n\"net/http\" \"github.com/gin-gonic/gin\"\n\"go.mongodb.org/mongo-driver/bson\"\n\"go.mongodb.org/mongo-driver/bson/primitive\"\ndbTools \"main/database\" )\ntype DbUser struct {\nID           primitive.ObjectID `bson:\"_id\"`\nFirstName    string             `bson:\"firstName\"`\nEmailAddress string             `bson:\"emailAddress\"`\n}\nfunc GetUser() gin.HandlerFunc {\nreturn func(c *gin.Context) {\ndb := dbTools.Database()\ndefer db.CancelContext()\nvar user DbUser\nerr := db.Current.Collection(\"user\").FindOne(db.Context, bson.M{\"emailAddress\": \"user@example.com\"}).Decode(&amp;user)\nif err != nil {\nfmt.Println(err)\n}\nc.JSON(http.StatusOK, user)\n}\n} </code></pre> <pre><code>import tensorflow as tf\n</code></pre> <pre><code>theme:\nfeatures:\n- content.code.annotate # (1)\n</code></pre> <p><pre><code>def bubble_sort(items):\nfor i in range(len(items)):\nfor j in range(len(items) - 1 - i):\nif items[j] &gt; items[j + 1]:\nitems[j], items[j + 1] = items[j + 1], items[j]\n</code></pre> .browserslistrc<pre><code>\n</code></pre></p>"},{"location":"Computers/Linux/Kvm/0098_Resources/","title":"Resources","text":"<p>https://dividebyzer0.gitlab.io/GPUpassthrough.html</p> <p>https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF</p> <p>Optiomization guide https://leduccc.medium.com/improving-the-performance-of-a-windows-10-guest-on-qemu-a5b3f54d9cf5</p>"},{"location":"Computers/Linux/Kvm/0098_Resources/#pinning","title":"PINNING","text":"<p>https://tlaguz.pl/post/debian-kvm-cpu-pinning/</p>"},{"location":"Computers/Linux/Kvm/0098_Resources/#hugepages","title":"Hugepages","text":"<p>https://access.redhat.com/solutions/36741</p> <p>https://qemu-project.gitlab.io/qemu/search.html?q=invtsc&amp;check_keywords=yes&amp;area=default</p> <p>https://mathiashueber.com/performance-tweaks-gaming-on-virtual-machines/</p> <pre><code>sudo pacman -Sy autoconf\nsudo pacman -Sy automake\nsudo pacman -Sy bin86\nsudo pacman -Sy bison\nsudo pacman -Sy csup\nsudo pacman -Sy diffutils\nsudo pacman -Sy ed\nsudo pacman -Sy fakeroot\nsudo pacman -Sy flex\nsudo pacman -Sy gcc\nsudo pacman -Sy libtool\nsudo pacman -Sy m4\nsudo pacman -Sy patch sudo pacman -Sy make sudo pacman -Sy pkgconfig\n</code></pre>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/","title":"Initial Setup","text":""},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#update-system","title":"Update system","text":"<pre><code>sudo pacman -Syu\n</code></pre>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#install-dependencies","title":"Install dependencies","text":"<pre><code>sudo pacman -S archlinux-keyring\nsudo pacman -S qemu virt-manager virt-viewer dnsmasq vde2 bridge-utils openbsd-netcat\nsudo pacman -S ebtables iptables\n</code></pre>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#install-libguestfs","title":"Install libguestfs","text":"<p>libguestfs is a set of tools used to access and modify virtual machine (VM) disk images. <pre><code>sudo pacman -S libguestfs\n</code></pre></p>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#start-libvirt","title":"Start libvirt","text":"<pre><code>sudo systemctl enable libvirtd.service\nsudo systemctl start libvirtd.service\n</code></pre>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#enable-normal-user-account-to-use-kvm","title":"Enable normal user account to use KVM","text":"<p>Open the file /etc/libvirt/libvirtd.conf for editing. /etc/libvirt/libvirtd.conf<pre><code>...\nunix_sock_group = \"libvirt\"\n...\nunix_sock_rw_perms = \"0770\"\n...\n</code></pre></p>"},{"location":"Computers/Linux/Kvm/0099_Initial_Setup/#add-your-user-account-to-libvirt-group","title":"Add your user account to libvirt group.","text":"<pre><code>sudo usermod -a -G libvirt $(whoami)\nnewgrp libvirt\nsudo systemctl restart libvirtd.service\n</code></pre>"},{"location":"Computers/Linux/Kvm/0100_Specs/","title":"Computer specs","text":"<p>All the configuration was tested with the following system specs</p> Part Name GPU AMD Ryzen\u2122 5 3600 RAM 32 GB MOTHERBOARD MSI B450 TOMAHAWK MAX GPU 1 AMD Radeon 6800 XT GPU 2 NVIDIA GTX 1080 Ti"},{"location":"Computers/Linux/Kvm/0200_IOMMU/","title":"IOMMU","text":"<p>Ensure that AMD-Vi/Intel VT-d is supported and enabled in the BIOS</p>"},{"location":"Computers/Linux/Kvm/0200_IOMMU/#list-out-iommu-groups","title":"List out IOMMU groups","text":"<pre><code>shopt -s nullglob\nfor g in $(find /sys/kernel/iommu_groups/* -maxdepth 0 -type d | sort -V); do\necho \"IOMMU Group ${g##*/}:\"\nfor d in $g/devices/*; do\necho -e \"\\t$(lspci -nns ${d##*/})\"\ndone;\ndone;\n</code></pre> <p>The output will list all the pci devices grouped by their IOMMU group number.</p> <pre><code>IOMMU Group 24:\n    25:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP102 [GeForce GTX 1080 Ti] [10de:1b06] (rev a1)\nIOMMU Group 25:\n    25:00.1 Audio device [0403]: NVIDIA Corporation GP102 HDMI Audio Controller [10de:10ef] (rev a1) </code></pre> <p>The GPU you wish to passthrough must not share a group with any other device. But this will not likely be the case. In that case you have to ACS patch the Kernel </p>"},{"location":"Computers/Linux/Kvm/0200_IOMMU/#acs-kernel-patch","title":"ACS Kernel Patch","text":"<pre><code>mkdir build &amp;&amp; cd build\ngit clone https://aur.archlinux.org/linux-vfio.git\nmakepkg -si\n# or\nmakepkg -si --skippgpcheck\n</code></pre>"},{"location":"Computers/Linux/Kvm/0300_Isolate_GPU/","title":"Isolate GPU","text":"<p>Assuming that the IOMMU groups are setup correctly you can now isolate the GPU you wish to passthrough.</p>"},{"location":"Computers/Linux/Kvm/0300_Isolate_GPU/#get-the-gpu-device-ids","title":"Get the GPU device ids","text":"<p>List the IOMMU groups <pre><code>shopt -s nullglob\nfor g in $(find /sys/kernel/iommu_groups/* -maxdepth 0 -type d | sort -V); do\necho \"IOMMU Group ${g##*/}:\"\nfor d in $g/devices/*; do\necho -e \"\\t$(lspci -nns ${d##*/})\"\ndone;\ndone;\n</code></pre></p> <p>The ids will be near the end of the device description and will be formatted like this: <code>[0000:0000]</code></p> <pre><code>IOMMU Group 24:\n    25:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP102 [GeForce GTX 1080 Ti] [10de:1b06] (rev a1)\nIOMMU Group 25:\n    25:00.1 Audio device [0403]: NVIDIA Corporation GP102 HDMI Audio Controller [10de:10ef] (rev a1) </code></pre> <p>In my case the ids are <code>10de:1b06</code> and <code>10de:10ef</code></p>"},{"location":"Computers/Linux/Kvm/0300_Isolate_GPU/#edit-the-grub-config","title":"Edit the grub config","text":"<p>Edit the grub file to isolate the gpu on startup</p> <p>Open <code>/etc/default/grub</code> and add the following parameters in the <code>GRUB_CMDLINE_LINUX_DEFAULT</code> option</p> <ul> <li>amd_iommu=on</li> <li>iommu=pt</li> <li>rd.driver.pre=vfio-pci</li> <li>transparent_hugepage=never <code>faster memory access for the VM</code></li> <li>vfio pci.ids=10de:1b06,10de:10ef <code>add your ids accordingly</code></li> <li>pcie_acs_override=downstream,multifunction <code>whether this option is good is debatable probably should remove</code></li> </ul> <p>My file looks like this:</p> /etc/default/grub<pre><code>...\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash apparmor=1 security=apparmor udev.log_priority=3 amd_iommu=on iommu=pt transparent_hugepage=never rd.driver.pre=vfio-pci vfio pci.ids=10de:1b06,10de:10ef pcie_acs_override=downstream,multifunction\"\n...\n</code></pre> <p>Apply grub configuration <pre><code>sudo grub-mkconfig -o /boot/grub/grub.cfg\n</code></pre></p>"},{"location":"Computers/Linux/Kvm/0400_Cpu_Pinning/","title":"Cpu pinning and isolation","text":"<p>Cpu pinning lets the virtual machine to run only on specified vcpus. You can combine this with cpu core isolation to achieve maximum performance.</p>"},{"location":"Computers/Linux/Kvm/0400_Cpu_Pinning/#use-lstopo-to-reference-the-cpu-topology","title":"Use lstopo to reference the cpu topology","text":"<p><pre><code>lstopo\n</code></pre> This is the output for AMD Ryzen\u2122 5 3600  </p> <p>From that we can link each core to its vcpus This cpu has 6 cpus and 2 threads per cpu, that makes for 12 vcpus:</p> CORE VCPU 1 VCPU 2 CORE 0 0 6 CORE 1 1 7 CORE 2 2 8 CORE 3 3 9 CORE 4 4 10 CORE 5 5 11 <p>Now you have to decide which and how many core to reserve for the host and how many for the guest.</p> <p>For this setup we will use core <code>0,1,2,3</code> for the guest vm and leave core <code>4</code> and <code>5</code> for the host.</p>"},{"location":"Computers/Linux/Kvm/0400_Cpu_Pinning/#get-the-vcpus","title":"Get the vcpus","text":"<p>From the topology of the cpu we can now find out the vcpus we need for the guest and the host.</p> <p>For the guest <code>0,6,1,7,2,8,3,9</code> vpus or <code>0-3,6-9</code> </p> <p>For the host <code>4,10,5,11</code> vcpus or <code>4-5,10-11</code></p>"},{"location":"Computers/Linux/Kvm/0400_Cpu_Pinning/#dynamic-cpu-isolation","title":"Dynamic cpu isolation","text":"<p>To isolate the vcpus at runtime we need to create a libvirt hook</p> <p>Create a script named <code>/etc/libvirt/hooks/qemu.d/isolate-cpus.sh</code></p> <p>Paste the following script after editing the <code>reserved</code> and <code>cores</code> variables</p> <p>The <code>reserved</code> variable refers to the guest vcpus, so for my case <code>0,6,1,7,2,8,3,9</code> The <code>cores</code> variable must have the whole range of vcpus of the system <code>0-11</code></p> <p>Script Source /etc/libvirt/hooks/qemu.d/isolate-cpus.sh<pre><code>#!/bin/bash\n# Cores reserved for the host machine\n# Must include QEMU IO/Emulation cores if configured\n# Ex: 1st Core -&gt; reserved=0\n# Ex: 1st &amp; 2nt Cores -&gt; reserved=0,1\n# Ex: 1st Physical Core (16 Virtual Cores) -&gt; reserved=0,8\nreserved=0-3,6-9\n\n# Host core range numbered from 0 to core count - 1\n# You must put all the cores of your host CPU\n# Cores not in $cores_for_host are for Guests\n# Ex: 8 Cores  -&gt; cores=0-7\n# Ex: 16 Cores -&gt; cores=0-15\ncores=0-11\n\n# See Arch wiki for more informations https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF#Isolating_pinned_CPUs\ncommand=$2\nvalid_cmds='prepare,start,started,stopped,release,migrate,restore'\nif [[ $command == \"started\" ]]; then\necho \"Hook/Qemu : isolate-cpus.sh : Isolate CPUS\"\nsystemctl set-property --runtime -- system.slice AllowedCPUs=$reserved\nsystemctl set-property --runtime -- user.slice AllowedCPUs=$reserved\nsystemctl set-property --runtime -- init.slice AllowedCPUs=$reserved\nelif [[ $command == \"release\" ]]; then\necho \"Hook/Qemu : isolate-cpus.sh : Allow all CPUS\"\nsystemctl set-property --runtime -- system.slice AllowedCPUs=$cores\nsystemctl set-property --runtime -- user.slice AllowedCPUs=$cores\nsystemctl set-property --runtime -- init.slice AllowedCPUs=$cores\nelif [[ $valid_cmds =~ $command ]]; then\necho \"Hook/Qemu : isolate-cpus.sh : Supported command but do nothing\"\nelse\necho \"Invalid commands. Ex: ./script vm_name [prepare|start|started|stopped|release|migrate|restore]\" &gt;&amp;2\nexit 1\nfi\n</code></pre></p> <p>With this method libvirt will isolate the cpus when the vm starts and return them to the host when the vm stops</p>"},{"location":"Computers/Linux/Kvm/0400_Cpu_Pinning/#static-cpu-isolation","title":"Static cpu isolation","text":"<p>This method is more straight forward but the host will always ignore the cpus reserved for the guest</p> <p>Edit the <code>/etc/default/grub</code> file and add to the GRUB_CMDLINE_LINUX_DEFAULT parameter:</p> <ul> <li>isolcpus=0-3,6-9</li> <li>nohz_full=0-3,6-9</li> <li>rcu_nocbs=0-3,6-9</li> </ul>"},{"location":"Computers/Linux/Kvm/0500_SwitchKeyboard/","title":"Switch keyboard and mouse","text":"<pre><code>git clone https://github.com/pavolelsig/evdev_helper.git\ncd evdev_helper\nsudo ./run_ev_helper.sh\n</code></pre> <p>Add the content of the <code>evdev.txt</code> to you vm configuration</p> <p>Press <code>LCTRL</code> + <code>RCTRL</code> to transfer keyboard and mouse input from the host to the vm and vice versa</p>"},{"location":"Computers/Linux/Kvm/0600_Fix_Audio_Latency%20copy/","title":"Fix audio latency","text":"<p>WARNING: Possibly unstable</p> <pre><code>&lt;qemu:commandline&gt;\n...\n  &lt;qemu:env name=\"QEMU_AUDIO_TIMER_PERIOD\" value=\"0\"/&gt;\n...\n&lt;/qemu:commandline&gt;\n</code></pre>"},{"location":"Computers/Linux/Kvm/0700_Virtual_Disks/","title":"RAW Virtual Disks","text":""},{"location":"Computers/Linux/Kvm/0700_Virtual_Disks/#create-and-format-virtual-disk","title":"Create and format virtual disk","text":"<pre><code>qemu-img create myimage.img 60G\nqemu-system-x86_64 -drive format=raw,file=myimage.img\n</code></pre>"},{"location":"Computers/Linux/Kvm/1000_Win11Vm/","title":"Win 11 Vm config","text":""},{"location":"Computers/Linux/Kvm/1000_Win11Vm/#avoid-bsods-on-new-windows-10-installs","title":"Avoid BSODs on New Windows 10 Installs","text":"/etc/modprobe.d/kvm.conf<pre><code>options kvm ignore_msrs=1\noptions kvm report_ignored_msrs=0\n</code></pre> <p>Win drivers ISO</p>"},{"location":"Computers/Linux/Kvm/1000_Win11Vm/#config","title":"Config","text":"<pre><code>&lt;domain xmlns:qemu=\"http://libvirt.org/schemas/domain/qemu/1.0\" type=\"kvm\"&gt;\n&lt;name&gt;win11&lt;/name&gt;\n&lt;uuid&gt;9c310e4c-3e1e-4a9c-8ce8-2041b64060a5&lt;/uuid&gt;\n&lt;metadata&gt;\n&lt;libosinfo:libosinfo xmlns:libosinfo=\"http://libosinfo.org/xmlns/libvirt/domain/1.0\"&gt;\n&lt;libosinfo:os id=\"http://microsoft.com/win/10\"/&gt;\n&lt;/libosinfo:libosinfo&gt;\n&lt;/metadata&gt;\n&lt;memory unit=\"KiB\"&gt;16777216&lt;/memory&gt;\n&lt;currentMemory unit=\"KiB\"&gt;16777216&lt;/currentMemory&gt;\n&lt;vcpu placement=\"static\"&gt;8&lt;/vcpu&gt;\n&lt;iothreads&gt;2&lt;/iothreads&gt;\n&lt;cputune&gt;\n&lt;vcpupin vcpu=\"0\" cpuset=\"0\"/&gt;\n&lt;vcpupin vcpu=\"1\" cpuset=\"6\"/&gt;\n&lt;vcpupin vcpu=\"2\" cpuset=\"1\"/&gt;\n&lt;vcpupin vcpu=\"3\" cpuset=\"7\"/&gt;\n&lt;vcpupin vcpu=\"4\" cpuset=\"2\"/&gt;\n&lt;vcpupin vcpu=\"5\" cpuset=\"8\"/&gt;\n&lt;vcpupin vcpu=\"6\" cpuset=\"3\"/&gt;\n&lt;vcpupin vcpu=\"7\" cpuset=\"9\"/&gt;\n&lt;emulatorpin cpuset=\"4-5,10-11\"/&gt;\n&lt;iothreadpin iothread=\"1\" cpuset=\"5,11\"/&gt;\n&lt;iothreadpin iothread=\"2\" cpuset=\"4,10\"/&gt;\n&lt;/cputune&gt;\n&lt;sysinfo type=\"smbios\"&gt;\n&lt;bios&gt;\n&lt;entry name=\"vendor\"&gt;American Megatrends Inc.&lt;/entry&gt;\n&lt;entry name=\"version\"&gt;3.50&lt;/entry&gt;\n&lt;/bios&gt;\n&lt;system&gt;\n&lt;entry name=\"manufacturer\"&gt;Micro-Star International Co., Ltd&lt;/entry&gt;\n&lt;entry name=\"product\"&gt;MS-7C02&lt;/entry&gt;\n&lt;entry name=\"version\"&gt;1.0&lt;/entry&gt;\n&lt;entry name=\"serial\"&gt;To be filled by O.E.M.&lt;/entry&gt;\n&lt;entry name=\"family\"&gt;To be filled by O.E.M.&lt;/entry&gt;\n&lt;/system&gt;\n&lt;/sysinfo&gt;\n&lt;os&gt;\n&lt;type arch=\"x86_64\" machine=\"pc-q35-7.1\"&gt;hvm&lt;/type&gt;\n&lt;loader readonly=\"yes\" type=\"pflash\"&gt;/usr/share/edk2-ovmf/x64/OVMF_CODE.secboot.fd&lt;/loader&gt;\n&lt;nvram&gt;/var/lib/libvirt/qemu/nvram/win11_VARS.fd&lt;/nvram&gt;\n&lt;bootmenu enable=\"no\"/&gt;\n&lt;smbios mode=\"host\"/&gt;\n&lt;/os&gt;\n&lt;features&gt;\n&lt;acpi/&gt;\n&lt;pae/&gt;\n&lt;hyperv mode=\"custom\"&gt;\n&lt;relaxed state=\"on\"/&gt;\n&lt;vapic state=\"on\"/&gt;\n&lt;spinlocks state=\"on\" retries=\"8191\"/&gt;\n&lt;vpindex state=\"on\"/&gt;\n&lt;synic state=\"on\"/&gt;\n&lt;stimer state=\"on\"/&gt;\n&lt;vendor_id state=\"on\" value=\"694206789ab\"/&gt;\n&lt;frequencies state=\"on\"/&gt;\n&lt;/hyperv&gt;\n&lt;vmport state=\"off\"/&gt;\n&lt;ioapic driver=\"kvm\"/&gt;\n&lt;/features&gt;\n&lt;cpu mode=\"custom\" match=\"exact\" check=\"none\"&gt;\n&lt;model fallback=\"allow\"&gt;EPYC&lt;/model&gt;\n&lt;topology sockets=\"1\" dies=\"1\" cores=\"4\" threads=\"2\"/&gt;\n&lt;feature policy=\"require\" name=\"topoext\"/&gt;\n&lt;feature policy=\"disable\" name=\"vmx\"/&gt;\n&lt;feature policy=\"require\" name=\"ibpb\"/&gt;\n&lt;feature policy=\"require\" name=\"pdpe1gb\"/&gt;\n&lt;feature policy=\"require\" name=\"virt-ssbd\"/&gt;\n&lt;feature policy=\"require\" name=\"amd-ssbd\"/&gt;\n&lt;feature policy=\"disable\" name=\"amd-no-ssb\"/&gt;\n&lt;feature policy=\"require\" name=\"stibp\"/&gt;\n&lt;/cpu&gt;\n&lt;clock offset=\"localtime\"&gt;\n&lt;timer name=\"rtc\" tickpolicy=\"catchup\"/&gt;\n&lt;timer name=\"pit\" tickpolicy=\"delay\"/&gt;\n&lt;timer name=\"hpet\" present=\"no\"/&gt;\n&lt;timer name=\"hypervclock\" present=\"yes\"/&gt;\n&lt;timer name=\"tsc\" present=\"yes\" mode=\"native\"/&gt;\n&lt;/clock&gt;\n&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;\n&lt;on_reboot&gt;restart&lt;/on_reboot&gt;\n&lt;on_crash&gt;destroy&lt;/on_crash&gt;\n&lt;pm&gt;\n&lt;suspend-to-mem enabled=\"no\"/&gt;\n&lt;suspend-to-disk enabled=\"no\"/&gt;\n&lt;/pm&gt;\n&lt;devices&gt;\n&lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;\n&lt;disk type=\"file\" device=\"disk\"&gt;\n&lt;driver name=\"qemu\" type=\"raw\" cache=\"none\" discard=\"unmap\"/&gt;\n&lt;source file=\"/run/media/sotig/M2/win10-gaming.img\"/&gt;\n&lt;target dev=\"sdd\" bus=\"sata\"/&gt;\n&lt;boot order=\"1\"/&gt;\n&lt;address type=\"drive\" controller=\"0\" bus=\"0\" target=\"0\" unit=\"3\"/&gt;\n&lt;/disk&gt;\n&lt;disk type=\"block\" device=\"disk\"&gt;\n&lt;driver name=\"qemu\" type=\"raw\" cache=\"none\" io=\"native\" discard=\"unmap\"/&gt;\n&lt;source dev=\"/dev/sdd\"/&gt;\n&lt;target dev=\"sde\" bus=\"sata\"/&gt;\n&lt;address type=\"drive\" controller=\"0\" bus=\"0\" target=\"0\" unit=\"4\"/&gt;\n&lt;/disk&gt;\n&lt;controller type=\"usb\" index=\"0\" model=\"qemu-xhci\" ports=\"15\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x02\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"0\" model=\"pcie-root\"/&gt;\n&lt;controller type=\"pci\" index=\"1\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"1\" port=\"0x10\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x0\" multifunction=\"on\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"2\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"2\" port=\"0x11\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x1\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"3\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"3\" port=\"0x12\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"4\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"4\" port=\"0x13\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x3\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"5\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"5\" port=\"0x14\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x4\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"6\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"6\" port=\"0x15\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x5\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"7\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"7\" port=\"0x16\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x6\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"8\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"8\" port=\"0x17\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x7\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"9\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"9\" port=\"0x18\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x0\" multifunction=\"on\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"10\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"10\" port=\"0x19\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x1\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"11\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"11\" port=\"0x1a\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"12\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"12\" port=\"0x1b\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x3\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"13\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"13\" port=\"0x1c\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x4\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"14\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"14\" port=\"0x1d\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x5\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"15\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"15\" port=\"0x1e\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x6\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"16\" model=\"pcie-to-pci-bridge\"&gt;\n&lt;model name=\"pcie-pci-bridge\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x01\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"sata\" index=\"0\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x1f\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;interface type=\"bridge\"&gt;\n&lt;mac address=\"52:54:00:dd:65:2e\"/&gt;\n&lt;source bridge=\"virbr0\"/&gt;\n&lt;model type=\"virtio\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x07\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/interface&gt;\n&lt;input type=\"mouse\" bus=\"ps2\"/&gt;\n&lt;input type=\"keyboard\" bus=\"ps2\"/&gt;\n&lt;input type=\"tablet\" bus=\"virtio\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x03\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/input&gt;\n&lt;tpm model=\"tpm-tis\"&gt;\n&lt;backend type=\"emulator\" version=\"2.0\"/&gt;\n&lt;/tpm&gt;\n&lt;graphics type=\"spice\"&gt;\n&lt;listen type=\"none\"/&gt;\n&lt;image compression=\"off\"/&gt;\n&lt;/graphics&gt;\n&lt;sound model=\"ac97\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x10\" slot=\"0x01\" function=\"0x0\"/&gt;\n&lt;/sound&gt;\n&lt;audio id=\"1\" type=\"spice\"/&gt;\n&lt;video&gt;\n&lt;model type=\"none\"/&gt;\n&lt;/video&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x25\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x04\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x25\" slot=\"0x00\" function=\"0x1\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x05\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x2a\" slot=\"0x00\" function=\"0x3\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x08\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;memballoon model=\"virtio\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x09\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/memballoon&gt;\n&lt;/devices&gt;\n&lt;qemu:commandline&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd1,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd2,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-if01-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=mouse1,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-if02-event-mouse\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=mouse2,evdev=/dev/input/by-id/usb-SteelSeries_SteelSeries_Rival_310_eSports_Mouse-if01-event-mouse\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd3,evdev=/dev/input/by-id/usb-SteelSeries_SteelSeries_Rival_310_eSports_Mouse-if02-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:env name=\"QEMU_AUDIO_TIMER_PERIOD\" value=\"0\"/&gt;\n&lt;/qemu:commandline&gt;\n&lt;/domain&gt;\n</code></pre>"},{"location":"Computers/Linux/Kvm/1100_LinuxVm/","title":"Linux Vm config","text":""},{"location":"Computers/Linux/Kvm/1100_LinuxVm/#config","title":"Config","text":"<pre><code>&lt;domain xmlns:qemu=\"http://libvirt.org/schemas/domain/qemu/1.0\" type=\"kvm\"&gt;\n&lt;name&gt;brive&lt;/name&gt;\n&lt;uuid&gt;c21d79ee-1f92-40da-a9cf-a9b93b8abf66&lt;/uuid&gt;\n&lt;metadata&gt;\n&lt;libosinfo:libosinfo xmlns:libosinfo=\"http://libosinfo.org/xmlns/libvirt/domain/1.0\"&gt;\n&lt;libosinfo:os id=\"http://fedoraproject.org/fedora/unknown\"/&gt;\n&lt;/libosinfo:libosinfo&gt;\n&lt;/metadata&gt;\n&lt;memory unit=\"KiB\"&gt;16777216&lt;/memory&gt;\n&lt;currentMemory unit=\"KiB\"&gt;16777216&lt;/currentMemory&gt;\n&lt;vcpu placement=\"static\"&gt;8&lt;/vcpu&gt;\n&lt;iothreads&gt;2&lt;/iothreads&gt;\n&lt;cputune&gt;\n&lt;vcpupin vcpu=\"0\" cpuset=\"0\"/&gt;\n&lt;vcpupin vcpu=\"1\" cpuset=\"6\"/&gt;\n&lt;vcpupin vcpu=\"2\" cpuset=\"1\"/&gt;\n&lt;vcpupin vcpu=\"3\" cpuset=\"7\"/&gt;\n&lt;vcpupin vcpu=\"4\" cpuset=\"2\"/&gt;\n&lt;vcpupin vcpu=\"5\" cpuset=\"8\"/&gt;\n&lt;vcpupin vcpu=\"6\" cpuset=\"3\"/&gt;\n&lt;vcpupin vcpu=\"7\" cpuset=\"9\"/&gt;\n&lt;emulatorpin cpuset=\"4-5,10-11\"/&gt;\n&lt;iothreadpin iothread=\"1\" cpuset=\"5,11\"/&gt;\n&lt;iothreadpin iothread=\"2\" cpuset=\"4,10\"/&gt;\n&lt;/cputune&gt;\n&lt;sysinfo type=\"smbios\"&gt;\n&lt;bios&gt;\n&lt;entry name=\"vendor\"&gt;American Megatrends Inc.&lt;/entry&gt;\n&lt;entry name=\"version\"&gt;3.50&lt;/entry&gt;\n&lt;/bios&gt;\n&lt;system&gt;\n&lt;entry name=\"manufacturer\"&gt;Micro-Star International Co., Ltd&lt;/entry&gt;\n&lt;entry name=\"product\"&gt;MS-7C02&lt;/entry&gt;\n&lt;entry name=\"version\"&gt;1.0&lt;/entry&gt;\n&lt;entry name=\"serial\"&gt;To be filled by O.E.M.&lt;/entry&gt;\n&lt;entry name=\"family\"&gt;To be filled by O.E.M.&lt;/entry&gt;\n&lt;/system&gt;\n&lt;/sysinfo&gt;\n&lt;os&gt;\n&lt;type arch=\"x86_64\" machine=\"pc-q35-7.1\"&gt;hvm&lt;/type&gt;\n&lt;loader readonly=\"yes\" type=\"pflash\"&gt;/usr/share/edk2-ovmf/x64/OVMF_CODE.secboot.fd&lt;/loader&gt;\n&lt;nvram&gt;/var/lib/libvirt/qemu/nvram/brive_VARS.fd&lt;/nvram&gt;\n&lt;bootmenu enable=\"no\"/&gt;\n&lt;smbios mode=\"host\"/&gt;\n&lt;/os&gt;\n&lt;features&gt;\n&lt;acpi/&gt;\n&lt;apic/&gt;\n&lt;pae/&gt;\n&lt;hyperv mode=\"custom\"&gt;\n&lt;relaxed state=\"on\"/&gt;\n&lt;vapic state=\"on\"/&gt;\n&lt;spinlocks state=\"on\" retries=\"8191\"/&gt;\n&lt;vpindex state=\"on\"/&gt;\n&lt;synic state=\"on\"/&gt;\n&lt;stimer state=\"on\"/&gt;\n&lt;vendor_id state=\"on\" value=\"694206789ab\"/&gt;\n&lt;frequencies state=\"on\"/&gt;\n&lt;/hyperv&gt;\n&lt;vmport state=\"off\"/&gt;\n&lt;ioapic driver=\"kvm\"/&gt;\n&lt;/features&gt;\n&lt;cpu mode=\"custom\" match=\"exact\" check=\"none\"&gt;\n&lt;model fallback=\"allow\"&gt;EPYC&lt;/model&gt;\n&lt;topology sockets=\"1\" dies=\"1\" cores=\"4\" threads=\"2\"/&gt;\n&lt;feature policy=\"require\" name=\"topoext\"/&gt;\n&lt;feature policy=\"disable\" name=\"vmx\"/&gt;\n&lt;feature policy=\"require\" name=\"ibpb\"/&gt;\n&lt;feature policy=\"require\" name=\"pdpe1gb\"/&gt;\n&lt;feature policy=\"require\" name=\"virt-ssbd\"/&gt;\n&lt;feature policy=\"require\" name=\"amd-ssbd\"/&gt;\n&lt;feature policy=\"require\" name=\"amd-no-ssb\"/&gt;\n&lt;feature policy=\"require\" name=\"stibp\"/&gt;\n&lt;/cpu&gt;\n&lt;clock offset=\"localtime\"&gt;\n&lt;timer name=\"rtc\" tickpolicy=\"catchup\"/&gt;\n&lt;timer name=\"pit\" tickpolicy=\"delay\"/&gt;\n&lt;timer name=\"hpet\" present=\"no\"/&gt;\n&lt;timer name=\"hypervclock\" present=\"yes\"/&gt;\n&lt;timer name=\"tsc\" present=\"yes\" mode=\"native\"/&gt;\n&lt;/clock&gt;\n&lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;\n&lt;on_reboot&gt;restart&lt;/on_reboot&gt;\n&lt;on_crash&gt;destroy&lt;/on_crash&gt;\n&lt;pm&gt;\n&lt;suspend-to-mem enabled=\"no\"/&gt;\n&lt;suspend-to-disk enabled=\"no\"/&gt;\n&lt;/pm&gt;\n&lt;devices&gt;\n&lt;emulator&gt;/usr/bin/qemu-system-x86_64&lt;/emulator&gt;\n&lt;disk type=\"file\" device=\"disk\"&gt;\n&lt;driver name=\"qemu\" type=\"raw\" cache=\"none\" discard=\"unmap\"/&gt;\n&lt;source file=\"/run/media/sotig/vmData/brive-disk.img\"/&gt;\n&lt;target dev=\"sdf\" bus=\"sata\"/&gt;\n&lt;boot order=\"1\"/&gt;\n&lt;address type=\"drive\" controller=\"0\" bus=\"0\" target=\"0\" unit=\"5\"/&gt;\n&lt;/disk&gt;\n&lt;controller type=\"usb\" index=\"0\" model=\"qemu-xhci\" ports=\"15\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x02\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"0\" model=\"pcie-root\"/&gt;\n&lt;controller type=\"pci\" index=\"1\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"1\" port=\"0x10\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x0\" multifunction=\"on\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"2\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"2\" port=\"0x11\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x1\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"3\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"3\" port=\"0x12\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"4\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"4\" port=\"0x13\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x3\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"5\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"5\" port=\"0x14\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x4\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"6\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"6\" port=\"0x15\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x5\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"7\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"7\" port=\"0x16\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x6\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"8\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"8\" port=\"0x17\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x02\" function=\"0x7\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"9\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"9\" port=\"0x18\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x0\" multifunction=\"on\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"10\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"10\" port=\"0x19\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x1\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"11\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"11\" port=\"0x1a\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"12\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"12\" port=\"0x1b\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x3\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"13\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"13\" port=\"0x1c\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x4\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"14\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"14\" port=\"0x1d\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x5\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"15\" model=\"pcie-root-port\"&gt;\n&lt;model name=\"pcie-root-port\"/&gt;\n&lt;target chassis=\"15\" port=\"0x1e\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x03\" function=\"0x6\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"pci\" index=\"16\" model=\"pcie-to-pci-bridge\"&gt;\n&lt;model name=\"pcie-pci-bridge\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x01\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"sata\" index=\"0\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x1f\" function=\"0x2\"/&gt;\n&lt;/controller&gt;\n&lt;controller type=\"sata\" index=\"1\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x10\" slot=\"0x01\" function=\"0x0\"/&gt;\n&lt;/controller&gt;\n&lt;interface type=\"bridge\"&gt;\n&lt;mac address=\"52:54:00:0e:8d:99\"/&gt;\n&lt;source bridge=\"virbr0\"/&gt;\n&lt;model type=\"virtio\"/&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x07\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/interface&gt;\n&lt;serial type=\"pty\"&gt;\n&lt;target type=\"isa-serial\" port=\"0\"&gt;\n&lt;model name=\"isa-serial\"/&gt;\n&lt;/target&gt;\n&lt;/serial&gt;\n&lt;console type=\"pty\"&gt;\n&lt;target type=\"serial\" port=\"0\"/&gt;\n&lt;/console&gt;\n&lt;input type=\"mouse\" bus=\"ps2\"/&gt;\n&lt;input type=\"keyboard\" bus=\"ps2\"/&gt;\n&lt;input type=\"tablet\" bus=\"virtio\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x03\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/input&gt;\n&lt;graphics type=\"spice\"&gt;\n&lt;listen type=\"none\"/&gt;\n&lt;image compression=\"off\"/&gt;\n&lt;/graphics&gt;\n&lt;sound model=\"ich9\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x00\" slot=\"0x1b\" function=\"0x0\"/&gt;\n&lt;/sound&gt;\n&lt;audio id=\"1\" type=\"spice\"/&gt;\n&lt;video&gt;\n&lt;model type=\"none\"/&gt;\n&lt;/video&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x25\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x04\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x25\" slot=\"0x00\" function=\"0x1\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x05\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;hostdev mode=\"subsystem\" type=\"pci\" managed=\"yes\"&gt;\n&lt;source&gt;\n&lt;address domain=\"0x0000\" bus=\"0x2a\" slot=\"0x00\" function=\"0x3\"/&gt;\n&lt;/source&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x08\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/hostdev&gt;\n&lt;memballoon model=\"virtio\"&gt;\n&lt;address type=\"pci\" domain=\"0x0000\" bus=\"0x06\" slot=\"0x00\" function=\"0x0\"/&gt;\n&lt;/memballoon&gt;\n&lt;/devices&gt;\n&lt;qemu:commandline&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd1,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd2,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-if01-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=mouse1,evdev=/dev/input/by-id/usb-Razer_Razer_BlackWidow-if02-event-mouse\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=mouse2,evdev=/dev/input/by-id/usb-SteelSeries_SteelSeries_Rival_310_eSports_Mouse-if01-event-mouse\"/&gt;\n&lt;qemu:arg value=\"-object\"/&gt;\n&lt;qemu:arg value=\"input-linux,id=kbd3,evdev=/dev/input/by-id/usb-SteelSeries_SteelSeries_Rival_310_eSports_Mouse-if02-event-kbd,grab_all=on,repeat=on\"/&gt;\n&lt;qemu:env name=\"QEMU_AUDIO_TIMER_PERIOD\" value=\"0\"/&gt;\n&lt;/qemu:commandline&gt;\n&lt;/domain&gt;\n</code></pre>"}]}